<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cadastro de Questões – UFF</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f7fa;
  margin: 0;
}
.header {
  background: #003A8F;
  color: #fff;
  padding: 20px;
  text-align: center;
}
.container {
  max-width: 900px;
  margin: 20px auto;
  background: #fff;
  padding: 30px;
  border-radius: 8px;
}
label {
  font-weight: bold;
  display: block;
  margin-top: 16px;
}
input, select, textarea {
  width: 100%;
  padding: 10px;
  margin-top: 6px;
}
textarea { min-height: 90px; }
button {
  margin-top: 24px;
  padding: 14px;
  width: 100%;
  background: #003A8F;
  color: #fff;
  border: none;
  font-size: 16px;
}
#resultado {
  margin-top: 20px;
  font-weight: bold;
}
</style>
</head>

<body>

<div class="header">
  <h2>Universidade Federal Fluminense</h2>
  <p>Cadastro de Questões para Banco Institucional</p>
</div>

<div class="container">
<form id="questaoForm">

<label>E-mail institucional</label>
<input id="email" type="email" required pattern="^[^@]+@id\.uff\.br$">

<label>Tipo de questão</label>
<select id="tipo" required>
  <option value="">Selecione</option>
  <option value="objetiva">Objetiva (múltipla escolha)</option>
  <option value="associacao">Associação / correlação</option>
</select>

<label>Enunciado da questão</label>
<textarea id="enunciado" required></textarea>

<label>Módulo</label>
<select id="modulo" required>
  <option value="">Selecione</option>
  <option>Anestesiologia</option>
  <option>Dermatologia</option>
  <option>Farmacologia</option>
  <option>Gastroenterologia</option>
  <option>Geriatria</option>
  <option>Ginecologia</option>
  <option>Imunologia</option>
  <option>Nefrologia</option>
  <option>Neonatologia</option>
  <option>Neurologia</option>
  <option>Obstetrícia</option>
  <option>Psiquiatria infantil</option>
  <option>Urologia</option>
</select>

<label>Assunto</label>
<select id="assunto" required disabled>
  <option value="">Selecione um módulo primeiro</option>
</select>

<label>Comentário do gabarito (opcional)</label>
<textarea id="comentario" maxlength="300"></textarea>

<button id="submitBtn" type="submit">Enviar questão</button>
<div id="resultado"></div>

</form>
</div>

<script>
const assuntosPorModulo = {
  "Anestesiologia": [
    "Avaliação pré-anestésica","Anestesia geral","Bloqueios centrais",
    "Monitorização","Reanimação cardiopulmonar","Reposição volêmica",
    "Intubação orotraqueal e oxigenoterapia","Segurança do paciente",
    "Gerenciamento da dor","Complicações em anestesia"
  ],
  "Dermatologia": [
    "Câncer de pele","Paraneoplasias","Farmacodermias","Leishmaniose",
    "Buloses","Lesões pigmentadas","Micoses profundas","Sífilis"
  ],
  "Farmacologia": [
    "Anticonstipantes","Antidiarreicos",
    "Antifiséticos, antieméticos, procinéticos",
    "Farmacologia da doença ácido-péptica",
    "Anti-histamínicos","Glicocorticóides",
    "Anti-tussígenos e antigripais","Farmacologia da asma"
  ],
  "Gastroenterologia": [
    "Hepatites virais","Doença ulcerosa péptica","Diarréia e parasitose",
    "Cirrose hepática e complicações","Pancreatites",
    "Intolerância e alergias alimentares",
    "Doença inflamatória intestinal","Tumores esofagogástricos",
    "CCR","Síndrome do Intestino Irritável e constipação intestinal",
    "DRGE","Hemorragia digestiva"
  ],
  "Geriatria": [
    "Alterações fisiológicas do envelhecimento",
    "Prescrição em idosos",
    "Grandes síndromes geriátricas",
    "Neurogeriatria"
  ],
  "Imunologia": [
    "Anafilaxia","Urticária","Rinite alérgica","Asma grave",
    "Alergia alimentar","Dermatite atópica",
    "Erros inatos da imunidade","Reação adversa a droga"
  ],
  "Nefrologia": [
    "Princípios do equilíbrio ácido-base",
    "Distúrbios ácido-base (acidoses)",
    "Balanço do K / distúrbios do K",
    "Hipercalcemia",
    "Regulação osmolar volêmica, distúrbio do Na e água",
    "Síndrome nefrótica","Glomerulonefrites e síndrome nefrítica",
    "Rim na gestação","Nefrite túbulo-intersticial",
    "Síndromes edemigênicas","Insuficiência renal aguda",
    "Doença renal crônica","Transplante renal"
  ],
  "Neurologia": [
    "1º e 2º neurônios motores","Demência","Epilepsia",
    "Doença de Parkinson e outros distúrbios do movimento",
    "Cefaleias","Doença cerebrovascular",
    "Coma e síncope","Neuropatias periféricas"
  ],
  "Urologia": [
    "Incontinência urinária","PGM1","PGM2","PGM3",
    "Disfunção sexual masculina","Transplante renal",
    "HPB","Trauma urológico","Litíase urinária",
    "Urgências urológicas"
  ]
};

const moduloSelect = document.getElementById("modulo");
const assuntoSelect = document.getElementById("assunto");

moduloSelect.onchange = () => {
  assuntoSelect.innerHTML = "";
  const assuntos = assuntosPorModulo[moduloSelect.value];

  if (!assuntos) {
    assuntoSelect.disabled = true;
    assuntoSelect.innerHTML = "<option>Sem assuntos cadastrados</option>";
    return;
  }

  assuntoSelect.disabled = false;
  assuntoSelect.innerHTML = "<option value=''>Selecione</option>";
  assuntos.forEach(a => {
    const opt = document.createElement("option");
    opt.textContent = a;
    assuntoSelect.appendChild(opt);
  });
};

const form = document.getElementById("questaoForm");
const submitBtn = document.getElementById("submitBtn");
const resultado = document.getElementById("resultado");

form.onsubmit = async e => {
  e.preventDefault();
  submitBtn.disabled = true;

  const idQuestao = new Date().toISOString();

  const payload = {
    id_questao: idQuestao,
    email: email.value,
    tipo: tipo.value,
    enunciado: enunciado.value,
    modulo: modulo.value,
    assunto: assunto.value,
    comentario_gabarito: comentario.value
  };

  try {
    const r = await fetch("https://webhook.artideia.com.br/webhook/cadastro_questoes", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    if (!r.ok) throw new Error();
    resultado.innerText = "Questão registrada com sucesso. ID: " + idQuestao;
    form.reset();
    assuntoSelect.disabled = true;
  } catch {
    alert("Erro ao enviar a questão.");
  } finally {
    submitBtn.disabled = false;
  }
};
</script>

</body>
</html>
